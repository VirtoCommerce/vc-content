<!-- Breadcrumb -->
{% unless template == 'index' or template == 'cart' %}
<div class="list list--breadcrumb" role="navigation" aria-label="breadcrumbs">
    <div class="list__item">
      <a class="list__link" href="{{ '/' | absolute_url }}" title="{{ 'general.breadcrumbs.home_link_title' | t }}">{{ 'general.breadcrumbs.home' | t }}</a>
    </div>

  {% if template contains 'vendor' or template contains 'product' or template contains 'collection' %}
    <div class="list__item">
        <a href="{{ '/apps' | absolute_url }}" class="list__link">App Store</a>
    </div>
  {% endif %}

  {% if template contains 'vendor' %}

    <div class="list__item">{{ vendor.name }}</div>

  {% elsif template contains 'product' %}

    {% if collection %}
      {% if collection.url %}
        <div class="list__item">
          <a href="{{ collection.url | absolute_url }}" class="list__link">{{ collection.title }}</a>
        </div>
      {% endif %}
    {% endif %}
    <div class="list__item">{{ product.title }}</div>

  {% elsif template contains 'collection' and collection.url %}

    {% if current_tags %}
      {% capture url %}{{ collection.url | absolute_url }}{% endcapture %}
      {{ collection.title | link_to: url }}

      {% comment %}
        Loop through tags and our custom tag array to strip out prepended tag categories if they exist.
        snippet/advanced-tag-loop.liquid is required for this to work.
      {% endcomment %}
      {% for tag in current_tags %}
        {% assign is_advanced_tag = false %}
        {% assign additional_tag = true %}
        {% if forloop.first %}
          {% assign additional_tag = false %}
        {% endif %}

        {% comment %}
          Track whether the tag gets printed
        {% endcomment %}
        {% assign found_tag = false %}
        
        {% for cat_item in collection.all_tags %}
          {% unless cat_item == '' %}

            {% if tag == cat_item %}
              {% assign is_advanced_tag = true %}
              {% if additional_tag %}
                <span>+</span>
              {% endif %}
              {% assign found_tag = true %}
              <span>
                {{ cat_item.label }}
              </span>
            {% endif %}
          {% endunless %}
        {% endfor %}

        {% comment %}
          We have a regular tag that wasn't printed, so print it now
        {% endcomment %}
        {% unless found_tag %}
          <!--<span>{{ tag }}</span>-->
        {% endunless %}

      {% endfor %}

    {% else %}
      <div class="list__item">{{ collection.title }}</div>
    {% endif %}

  {% elsif template == 'blog' %}

    {% if current_tags %}
      {% assign blog_url = blog.url | absolute_url %}
      {{ blog.title | link_to: blog_url }}
      <span>{{ current_tags | join: " + " }}</span>
    {% else %}
      <div class="list__item">{{ blog.title }}</div>
    {% endif %}

  {% elsif template contains 'article' or page == 'blog' %}

    <div class="list__item">
        <a href="{{ blog.url | absolute_url }}" class="list__link">{{ blog.title }}</a>
    </div>
    {% if article.meta_fields.articleTitle != null %}
        <div class="list__item">{{ article.meta_fields.articleTitle }}</div>
    {% endif %}

  {% elsif template contains 'page' %}

    {% assign page_url_starts_with_glossary = page.url | slice: 0, 8 %}
    {% if page_url_starts_with_glossary != 'glossary' %}
        {%- assign menu_tabs = linklists['main-menu'] -%}
        {%- for tab in menu_tabs.links -%}
          <!--blocks-->
          {%- assign tab_blocks = linklists[tab.url].links -%}
          {%- for current_block in tab_blocks -%}
            {%- assign current_links = linklists[current_block.url].links -%}
            {% if current_links contains page.url %}
              <div class="list__item">
                <a href="{{ current_links[0].url | absolute_url }}" class="list__link">{{ tab.title }}</a>
              </div>
            {% endif %}
          {%- endfor -%}
        {%- endfor -%}
    {% else %}
        {%- assign glossary_links = linklists['Glossary'].links -%}
        {% assign found_link = glossary_links | where: 'Url', 'contains', page.url | first %}
        {% if found_link and page.url != 'glossary' %}
            <div class="list__item">
                <a href="{{ 'glossary' | absolute_url }}" class="list__link selected">Glossary</a>
            </div>
        {% endif %}

        {% if page.url == 'glossary' %}
            <div class="list__item">Glossary</div>
        {% else %}
            {% assign current_glossary_page = linklists['Glossary'].links | where: 'Url', '==', (page.url | prepend: '/') %}
            {% if current_glossary_page != blank %}
                <div class="list__item">{{(current_glossary_page | first).title}}</div>
            {% else %}
                {% if page.title != null %}
                    <div class="list__item">{{page.title}}</div>
                {% elsif page.meta_fields.header != null %}
                    <div class="list__item">{{page.meta_fields.header}}</div>
                {% endif %}
            {% endif %}
        {% endif %}
    {% endif %}
  {% else %}

   <div class="list__item">{{ page_title }}</div>
  {% endif %}
</div>
{% endunless %}
